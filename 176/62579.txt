                 Cladistics 1 (2012) 1–6
Cladistics
10.1111/j.1096-0031.2012.00401.x
  Analysis and visualization of H7 influenza using genomic, evolutionary and geographic information in a modular web service
Daniel A. Janiesa,*, , Laura W. Pomeroyb, Jacob M. Aaronsona, Samuel Handelmana, Jori Hardmana, Kevin Kawaleca, Thomas Bittermanc and Ward C. Wheelerd
aDepartment of Biomedical Informatics, Ohio State University, Columbus, OH 43210 USA; bDepartment of Veterinary Preventative Medicine, Ohio State University, Columbus, OH 43210 USA; cThe Ohio Supercomputer Center, Columbus, OH 43212, USA; dDivision of Invertebrate Zoology, American Museum of Natural History, New York, NY, 10024, USA
Accepted 12 March 2012
Abstract
We have reported previously on use of a web-based application, Supramap (http://supramap.org) for the study of biogeographic, genotypic, and phenotypic evolution. Using Supramap we have developed maps of the spread of drug-resistant influenza and host shifts in H1N1 and H5N1 influenza and coronaviruses such as SARS. Here we report on another zoonotic pathogen, H7 influenza, and provide an update on the implementation of Supramap as a web service. We find that the emergence of pathogenic strains of H7 is labile with many transitions from high to low pathogenicity, and from low to high pathogenicity. We use Supramap to put these events in a temporal and geospatial context. We identify several lineages of H7 influenza with biomarkers of high pathogenicity in regions that have not been reported in the scientific literature. The original implementation of Supramap was built with tightly coupled client and server software. Now we have decoupled the components to provide a modular web service for POY (http:// poyws.org) that can be consumed by a data provider to create a novel application. To demonstrate the web service, we have produced an application, Geogenes (http://geogenes.org). Unlike in Supramap, in which the user is required to create and upload data files, in Geogenes the user works from a graphical interface to query an underlying dataset. Geogenes demonstrates how the web service can provide underlying processing for any sequence and metadata database.
  Use case H7 influenza A
Hosts
Influenza A viruses of subtype H7 typically infect birds of the orders Anseriformes and Charadriiformes (Webster et al., 1992, 2007). An outbreak of H7N7 infected Galliformes and humans in the Netherlands (Koopmans et al., 2003, 2004; Fouchier et al., 2004; Stegeman et al., 2004). Outbreaks of H7 viruses have been reported in Galliformes in Australia (Selleck et al., 2003; Bulach et al., 2010), Germany (Ro ̈ hm et al., 1996), Italy (Capua et al., 2002), Canada (Hirst et al., 2004; Pasick
*Corresponding author:
E-mail address: supramap@gmail.com
Present address: Bioinformatics and Genomics, University of North Carolina at Charlotte, Charlotte, NC 28223, USA.
et al., 2005; Berhane et al., 2009), China (Li et al., 2006), the United Kingdom (Nguyen-Van-Tam et al., 2006), Chile (Spackman et al., 2006), the United States (Suarez et al., 1999; Spackman et al., 2003; Belser et al., 2009), and Pakistan (Abbas et al., 2010). In Brazil, H7N7 isolates were first discovered in equine hosts in 1976 (Gibson et al., 1992).
Pathogenicity
Low pathogenic (LP) H7 viruses exhibit localized replication in the respiratory and intestinal tracts, transmit through fecal–oral routes, and cause less mortality among infected hosts (Alexander, 2000; Horimoto and Kawaoka, 2005). In contrast, highly pathogenic (HP) viruses replicate systemically, transmit through aerosol routes, and cause greater mortality in their hosts (Alexander, 2000; Horimoto and Kawaoka, 2005).
 Ó The Willi Hennig Society 2012

2 D.A. Janies et al. / Cladistics 1 (2012) 1–6
Pathogenicity is a complex trait (Stech et al., 2009). Viral molecular evolution associated with pathogenicity can occur via point mutations or intersegmental recombination (Hirst et al., 2004). Many suggest that three or more polybasic amino acid inserts 5¢ of the HA proteolytic cleavage site serves as a biomarker for pathogenicity (Chen et al., 1998; Steinhauer, 1999). However, recent studies have shown that this model is not universally applicable (Ro ̈ hm et al., 1996; Senne et al., 1996; OIE, 2009; Uchida et al., 2011). While acknowledging improvements in molecular understanding of viral pathogenicity, the World Organization for Animal Health (OIE [Office International des Epizooties]) uses animal testing to assess pathogenicity. Pathogenic viruses are classified as such when they cause 75% mortality in chicks that have been inoculated with a strain of interest (Alexander, 2003; OIE, 2009).
Implementation
In previous reports, we focused on hypothesis-driven investigation and the development of the web application Supramap (http://supramap.org). We have used Supramap in several studies to perform combined genetic and phenotypic analysis with geographic visualization to understand the spread of viral lineages, key mutations, and host shifts (Janies et al., 2007, 2008, 2010a). Supramap is distinct from tree visualization systems because we use POY (Varo ́ n et al., 2010), which can search for alignments and ⁄ or trees, diagnose trees, and output data on mutations and ⁄ or phenotypic changes. As a result, users from around the world have used Supramap to investigate such diverse topics as the biogeography of plant pathogens (Lokossou et al., 2010), the integration of biodiversity and evolutionary biology (Hendry et al., 2010), ecogeographic genetic epidemiology (Sloan et al., 2009), and human cultural evolution (Wheeler et al., 2011).
Here we focus on the development and use of a modular processing and visualization service that can be consumed by application developers. Currently this service is hosted on a large shared system at the Ohio Supercomputer Center (OSC; http://poyws.org) and on a smaller dedicated cluster in the OSU Medical Center.
Geogenes is an application that increases the usability of our software by providing an entirely graphically driven query interface to the underlying data and processing services. We describe Geogenes in detail below. Geogenes is just one example of an application that can be produced by the service. The software service can be coupled with diverse data sources supporting a variety of applications across the natural and biomedical sciences.
Methods
Raw data
We downloaded nucleotide data from GenBank (http://ncbi.nlm.nih.gov) and EPIFLU (http://www. gisaid.org). We used HA nucleotide sequences of the influenza A H7 subtype and their metadata that were available on 15 September 2011. We filtered out lowquality sequences (e.g. those that were < 75% of the average sequence length) and isolates with metadata indicating they were adapted to laboratory conditions. Sequences were aligned with ClustalW (Larkin et al., 2007) and both the 5¢ and 3¢ ends were trimmed manually to remove sequencing artefacts. The resulting dataset had 878 pre-aligned sequences. We used the oldest isolate, A ⁄ chicken ⁄ Brescia ⁄ 1902, as the outgroup. We ran the POY search under equal weights for all edit costs as specified by tcm:(1,1), under the command search(max_time:0:16:0, memory:gb:2), on a 60-CPU (central processing unit) cluster.
Character coding of pathogenicity
Due to its complexity, in this study we coded pathogenicity as a categorical character with three states: low pathogenicity (two basic AA), borderline (three basic AA or four basic AA but empirically determined to be LP), or high pathogenicity (three basic AA but empirically determined to be HP, 4–8 basic AA). We identified the number of basic amino acids flanked by the motifs PXPX or PXXP at the C-terminus of the cleavage site and GLFGAIA at the N-terminus of the loop (Vey et al., 1992).
Geographic data
Place names from viral metadata were converted to latitudes and longitudes by the procedure described in Janies et al. (2010b). Pathogenicity and geographic data are posted at http://dx.doi.org/10.5061/dryad.c2401.
Graphical interface
The graphical interface that we have created for Geogenes allows a user to select data from a variety of sources (e.g. various genes, taxa, hosts, times, geographic regions) via a query. The use of a graphical interface frees the users from editing input files, a process that is error-prone. After a query is processed, Geogenes allows the user to submit the data for execution in the processing service. Within an individual user account, the queries and results can be stored for later processing, for example with updated data. Queries and results can be shared with other

users such that the workflow underlying the science is repeatable.
Processing
Many of the aspects of comparative genomic research, such as multiple sequence alignment and tree search, require large numbers of processors available only in high-performance computers (HPCs; e.g. a scheduled supercomputer, dedicated cluster, multicore server, grid, or cloud). Often the setup required of the user for HPCs presents a significant hurdle. In order to remove the burdens–such as acquisition and maintenance of hardware, installation of languages and middleware, compilation of applications, configuration of accounts, production of scripts, navigation of schedulers, and use of the command line interface—we have developed a processing service that executes these analyses on many CPUs via the click of a button on a web page.
The first version of Supramap ran on a small computing cluster and its client and server were tightly coupled (Janies et al., 2010a). We have now created a generic and modular web service that runs POY (Varo ́ n et al., 2010) with Supramap as a plugin under a scheduler on a large cluster. In addition to Geogenes, Supramap (http://supramap.org) currently consumes the processing service.
Visualization
Once an analysis is complete, the service creates several files that can be viewed with external applications. For example, the keyhole markup language (KML) files can be viewed with Google Earth (http://earth.google.com), NASA World Wind (http://worldwind.arc.nasa.gov), or ArcGIS Explorer (http://www.esri.com/software/arcgis/ explorer).
The trees files are produced in NEWICK format and can be viewed with TreeView (http://taxonomy. zoology.gla.ac.uk/rod/treeview.html) or similar tools. Implied alignments are produced in FASTA format and can be viewed with a variety of text editors or alignmentediting tools. Trees and implied alignments can be visualized in concert with Mesquite (http://mesquiteproject.org).
Service infrastructure
Documentation of the web serviceÕs programmatic interface can be found at http://poyws.org. The service is defined in web service definition language (WSDL). There are five basic methods that are executed in a stepwise fashion to use the web service. First, a web method is used to initialize a job. This step creates an empty directory on the HPC resource. Second, another web method uploads each file. Third, a method submits
D.A. Janies et al. / Cladistics 1 (2012) 1–6 3
 Fig. 1. Screenshot of Keyhole Markup Language (KML) file of the spread of H7 influenza as viewed via the hemagglutinin gene. The KML was produced by SUPRAMAP and visualized by Google EarthÔ. Red lines depict high pathogenic lineages, green lines show low pathogenic lineages, and purple lines represent lineages in a borderline state of pathogenicity. This circumarctic view illustrates the historical spread of high pathogenic lineages (high altitude red lines) and the recent local evolution of high pathogenicity (low altitude red lines).

4 D.A. Janies et al. / Cladistics 1 (2012) 1–6
the job via the scheduler on the HPC resource via qsub (a command of portable batch system). Fourth, a method is provided for the client to call periodically to see if the job completes. Fifth, a method is used to retrieve the output files. There is a sixth, optional method that serves to clean up after a run by deleting the directory created during initialization. The initialization method can be modified such that alternative resources (e.g. a scheduled supercomputer or dedicated cluster) can be selected as a parameter. All subsequent methods for that job would use the same resource.
The web service is hosted on its own server, separately from clients that consume it as well as the HPC resource. This service communicates to its clients via WSDL and interacts with the HPC resource via secure shell (SSH) and secure shell file transfer (SFTP) protocols. We used the sharpSsh (http://www.codeproject.com/KB/IP/ sharpssh.aspx), a DLL library, to accomplish this communication. Security is achieved by authentication, encryption, and validation of web requests.
Results
The KML file is posted at http://dx.doi.org/10.5061/ dryad.c2401) (Fig. 1). The H7 HA tree had 6858 steps and implies two transitions from HP to LP, seven transitions from LP to HP, four transitions from LP to borderline, and one transition from HP to borderline. We identify lineages with HP biomarkers in Argentina, Australia, Belgium, Brazil, Canada, Chile, Egypt, Germany, Italy, Japan, the Netherlands, Pakistan, Taiwan, the United Kingdom, the United States, and Uruguay. Borderline pathogenic lineages occur in Japan and the United States. Data on HP lineages from China were not available.
Discussion
Our results indicate that pathogenicity is a highly labile trait that is more geographically diverse than reported in the literature. Our visualization shows that pathogenicity was historically spread among continents (high-altitude red lines in Fig. 1) but recently has emerged via de novo, local evolution of viruses (lowaltitude red lines in Fig. 1).
In addition to the HP lineages revealed by the literature survey in the Introduction, we visualize HP lineages in Argentina, Belgium, Chile, Egypt, Japan, Taiwan, and Uruguay. In some cases, HP lineages have changed to LP lineages. This pattern is consistent with a hypothesis that continued transmission of viruses depends on infection among relatively healthy hosts (Ewald, 2002). Improvements in our understanding of the molecular bases of pathogenicity, and better meta-
data on phenotypes associated with public genomic data, will improve future studies.
In summary, we have created a simple and flexible web service for genetic surveillance of disease that can also be used to create applications across a broad variety of scientific investigations. Please contact the corresponding author via email for further information on code and web services.
Acknowledgements
We acknowledge that this material is based on work supported by, or in part by, the US Army Research Laboratory and Office under grant number W911NF05-1-0271. We acknowledge the support of the American Museum of Natural History and the Department of Biomedical Informatics of Ohio State University (OSU). We thank the Medical Center Information Services team of OSU and the Ohio Supercomputer Center for hosting computing clusters used in this study. We thank the offices of Academic Affairs and Research of OSU for their support of the Innovation Group on Global Infectious Disease Research, http://gidr.osu.edu.
References
